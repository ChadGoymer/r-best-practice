<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Package Development</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Best Practice</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="software.html">Software</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Writing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="writing-style.html">Style</a>
    </li>
    <li>
      <a href="writing-structure.html">Structure</a>
    </li>
    <li>
      <a href="writing-rmarkdown.html">R Markdown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="packages-wrangling.html">Data Wrangling</a>
    </li>
    <li>
      <a href="packages-modelling.html">Modelling</a>
    </li>
    <li>
      <a href="packages-visualisation.html">Visualisation</a>
    </li>
    <li>
      <a href="packages-optimisation.html">Optimisation</a>
    </li>
    <li>
      <a href="packages-development.html">Package development</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Development
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="development-version-control.html">Version Control</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="advanced-non-standard-evaluation.html">Non-Standard Evaluation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="cheatsheets.html">Cheatsheets</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Package Development</h1>

</div>


<p>Package development has been made very easy with a number of packages to facilitate each step of the process. The following packages are recommended:</p>
<ul>
<li><a href="https://www.rdocumentation.org/packages/usethis"><code>usethis</code></a>: Automates package setup tasks</li>
<li><a href="https://www.rdocumentation.org/packages/devtools"><code>devtools</code></a>: Simplifies package development tasks</li>
<li><a href="https://www.rdocumentation.org/packages/roxygen2"><code>roxygen2</code></a>: Builds package documentation</li>
<li><a href="https://www.rdocumentation.org/packages/testthat"><code>testthat</code></a>: Specify and execute tests</li>
</ul>
<p>RStudio provides a cheatsheet detailing the package development process:</p>
<div class="row">
<div class="col-sm-3">
<a class="thumbnail" title="Package Development" href="https://github.com/rstudio/cheatsheets/raw/master/package-development.pdf">
<img src="images/package-development.png"/>
<div class="caption">Package Development</div>
</a>
</div>
</div>
<p>Note: the cheatsheet is a little out of date. Some of the functions used have now been split out into the <a href="https://www.rdocumentation.org/packages/usethis"><code>usethis</code></a> package.</p>
<div id="creating-a-package" class="section level2">
<h2>Creating a package</h2>
<p>The first step is to create the basic package structure. This is simple with RStudio, or the <a href="https://www.rdocumentation.org/packages/usethis"><code>usethis</code></a> package:</p>
<ul>
<li>In RStudio, create a new project and select the “R package” option.</li>
<li>Otherwise, use <a href="https://www.rdocumentation.org/packages/usethis/topics/create_package"><code>usethis::create_package()</code></a>.</li>
</ul>
<p>Both create a skeletal structure for a package:</p>
<ul>
<li><strong>DESCRIPTION</strong> (file): documention for the package</li>
<li><strong>NAMESPACE</strong> (file): lists the functions to expose to a user (should not be edited directly)</li>
<li><strong>R</strong> (directory): location for R code</li>
<li><strong>man</strong> (directory): location for function documentation (should not be edited directly)</li>
</ul>
</div>
<div id="description" class="section level2">
<h2>DESCRIPTION</h2>
<p>Open up the DESCRIPTION file in a text editor. You should edit:</p>
<ul>
<li>“Title”: Single sentence description of the package.</li>
<li>“Version”: Version to be incremented when new functionality is added.</li>
<li>“Author” (&amp; “Maintainer”, if different): Use the format:</li>
</ul>
<pre><code>Authors@R: person(&quot;Hadley&quot;, &quot;Wickham&quot;, email = &quot;hadley@me.com&quot;, role = c(&quot;aut&quot;, &quot;cre&quot;))</code></pre>
<ul>
<li>“Description”: A paragraph describing the package in more detail.</li>
<li>“License”: Should be set if you intend to make the package available to the public.</li>
<li>“Imports”: If your package depends on others they need to included here. Use <a href="https://www.rdocumentation.org/packages/usethis/topics/use_package"><code>usethis::use_package()</code></a> to specify them.</li>
</ul>
</div>
<div id="r-code" class="section level2">
<h2>R code</h2>
<ul>
<li>The R code in a package should only contain functions, classes or data.</li>
<li>All scripts are run when the package is built.</li>
<li>Do not use <code>source</code>, <code>library</code> and/or <code>require</code> in the code. All dependencies should be defined in the DESCRIPTION file.</li>
<li>Design R functions to do one thing well and be as simple as possible.</li>
<li>You can decide which functions are available to the user of a package and which ones are only available internal to the package using the <code>export</code> keyword explained in <a href="packages-development.html#documentation">documenation</a>.</li>
<li>Use <a href="https://www.rdocumentation.org/packages/devtools/topics/load_all"><code>devtools::load_all()</code></a> to load all the functions to test out.</li>
</ul>
</div>
<div id="documentation" class="section level2">
<h2>Documentation</h2>
<div id="function-help" class="section level4">
<h4>Function help</h4>
<p>Each function exported from a package should be documented using <a href="https://www.rdocumentation.org/packages/roxygen2"><code>roxygen2</code></a>-syle comments. To start, execute <a href="https://www.rdocumentation.org/packages/usethis/topics/use_roxygen_md"><code>usethis::use_roxygen_md()</code></a> so <a href="writing-rmarkdown.html#markdown">markdown</a> can be used.</p>
<p>Before the function definition write a special comment block, where each line starts with <code>#'</code>. Then the format is as follows:</p>
<ul>
<li>The first line(s) form the title.</li>
<li>Any subsequent paragraphs, without keywords, become the description.</li>
<li>Detail function arguments using the <code>@param</code> keyword.</li>
<li>Detail what the function returns with <code>@return</code>.</li>
<li>Make the function available for use when the package is loaded with <code>@export</code></li>
<li>Use <a href="https://www.rdocumentation.org/packages/devtools/topics/document"><code>devtools::document()</code></a> to generatate all the help files.</li>
</ul>
<p>There are other keywords available, but the above should be the minimum documented. Here is a simple example:</p>
<pre class="r"><code>#&#39; The length of a string.
#&#39;
#&#39; This function returns the number of characters in the supplied string.
#&#39; 
#&#39; @param string input character vector
#&#39;
#&#39; @return integer vector giving number of characters in each element of the
#&#39;   character vector.
#&#39;
#&#39; @export
#&#39;
str_length &lt;- function(string) {
  nchar(string)
}</code></pre>
</div>
<div id="vignettes" class="section level4">
<h4>Vignettes</h4>
<p>Function documentation is great for reference, however, to describe how a package should be used you need a vignette. A vignette is like an article or paper on a topic your package addresses. To write a vignette you need the <a href="https://rmarkdown.rstudio.com"><code>rmarkdown</code></a> package and <a href="https://pandoc.org">Pandoc</a> installed. RStudio installs these automatically.</p>
<ul>
<li>Use <a href="https://www.rdocumentation.org/packages/usethis/topics/use_vignette"><code>usethis::use_vignettes()</code></a> to create a vignette</li>
<li>Edit the file created in the <code>vignettes</code> folder using <a href="writing-rmarkdown.html#markdown">markdown</a></li>
<li>Press Ctrl/Cmd + Shift + K (or click “Knit”) to knit the vignette and preview the output.</li>
</ul>
</div>
</div>
<div id="testing" class="section level2">
<h2>Testing</h2>
<p>Testing is a vital part of model development. It checks your functions are doing what they are supposed to and checks any updates have not had unintended side effects. They are also vital for testing that updates made to R or dependent packages have not broken your functions. To write tests you need the <a href="https://www.rdocumentation.org/packages/testthat"><code>testthat</code></a> package.</p>
<ul>
<li>Use <a href="https://www.rdocumentation.org/packages/usethis/topics/use_testthat"><code>usethis::use_testthat()</code></a> to set up testing.</li>
<li>Use <a href="https://www.rdocumentation.org/packages/usethis/topics/use_test"><code>usethis::use_test()</code></a> to create an test file then edit it to add individual tests.</li>
<li>Run all you tests using <a href="https://www.rdocumentation.org/packages/devtools/topics/test"><code>devtools::test()</code></a></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
