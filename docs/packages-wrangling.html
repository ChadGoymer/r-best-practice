<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Data Wrangling</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Best Practice</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="software.html">Software</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Writing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="writing-style.html">Style</a>
    </li>
    <li>
      <a href="writing-structure.html">Structure</a>
    </li>
    <li>
      <a href="writing-rmarkdown.html">R Markdown</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="packages-wrangling.html">Data Wrangling</a>
    </li>
    <li>
      <a href="packages-modelling.html">Modelling</a>
    </li>
    <li>
      <a href="packages-visualisation.html">Visualisation</a>
    </li>
    <li>
      <a href="packages-optimisation.html">Optimisation</a>
    </li>
    <li>
      <a href="packages-development.html">Package development</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Development
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="development-version-control.html">Version Control</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="advanced-non-standard-evaluation.html">Non-Standard Evaluation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="cheatsheets.html">Cheatsheets</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Data Wrangling</h1>

</div>


<blockquote>
<p>Data wrangling is the process of transforming and mapping data from one “raw” data form into another format with the intent of making it more appropriate and valuable for a variety of downstream purposes such as analytics.</p>
<p>– <a href="https://en.wikipedia.org/wiki/Data_wrangling"><em>Wikipedia</em></a></p>
</blockquote>
<div id="tidy-data" class="section level2">
<h2>Tidy Data</h2>
<p>The Tidyverse of packages are built around the concept of tidy data, first introduced by Jeff Leek in his book <em>The Elements of Data Analytic Style</em>. Hadley Wickham summarises the characteristics of <a href="http://tidyr.tidyverse.org/articles/tidy-data.html">tidy data</a> with the following points:</p>
<ol style="list-style-type: decimal">
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ol>
</div>
<div id="cheatsheets" class="section level2">
<h2>Cheatsheets</h2>
<p>RStudio provide a selection of cheatsheets containing quick reference of R functions useful for common task:</p>
<p><div class="col-sm-3">
<a class="thumbnail" title="Data Import" href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">
<img src="images/data-import-cheatsheet-1.png"/>
<div class="caption">Data Import</div>
</a>
</div><div class="col-sm-3">
<a class="thumbnail" title="Data Transformation" href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">
<img src="images/data-transformation-cheatsheet.png"/>
<div class="caption">Data Transformation</div>
</a>
</div><div class="col-sm-3">
<a class="thumbnail" title="Strings" href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf">
<img src="images/strings.png"/>
<div class="caption">Strings</div>
</a>
</div><div class="col-sm-3">
<a class="thumbnail" title="Dates and Times" href="https://github.com/rstudio/cheatsheets/raw/master/lubridate.pdf">
<img src="images/lubridate.png"/>
<div class="caption">Dates and Times</div>
</a>
</div></p>
</div>
<div id="importing-data" class="section level2">
<h2>Importing Data</h2>
<p>The first step in wrangling is importing the data into R. The methods to do so depend on the source of data:</p>
<ul>
<li>Reading files</li>
<li>Connecting to databases</li>
<li>Web APIs or pages</li>
</ul>
<div id="reading-files" class="section level4">
<h4>Reading Files</h4>
<p>Files may come in many formats and R has packages to read many of them. The most common for data science are tabular text files, such as CSVs, and Excel spreadsheets. The recommended packages for reading these files are:.</p>
<ul>
<li><a href="http://readr.tidyverse.org/"><code>readr</code></a> for reading text files</li>
<li><a href="http://readxl.tidyverse.org/"><code>readxl</code></a> for reading Excel files</li>
<li><a href="https://www.rdocumentation.org/packages/openxlsx/"><code>openxlsx</code></a> for writing to Excel files</li>
</ul>
</div>
<div id="connecting-to-databases" class="section level4">
<h4>Connecting to Databases</h4>
<p>The new <a href="https://db.rstudio.com/">RStudio Connections Pane</a> makes it possible to easily connect to a variety of data sources, and explore the objects and data inside the connection.</p>
<p>The recommended packages for connecting to databases (also used by RStudio) are:</p>
<ul>
<li><a href="https://db.rstudio.com/DBI"><code>DBI</code></a> provides a standard interface to any database</li>
<li><a href="https://db.rstudio.com/odbc/"><code>odbc</code></a> for connecting to databases using ODBC</li>
<li><a href="https://db.rstudio.com/dplyr/"><code>dplyr</code></a> for transforming tables in a database</li>
</ul>
</div>
<div id="web-apis-and-pages" class="section level4">
<h4>Web APIs and Pages</h4>
<p>Obtaining data from the internet has two main approaches. If the website provides an application programming interface (API) then you can send and receive data through it. The data from web APIs is usually returned in JSON or XML format. Alternatively, you can scrape the website itself, extracting data from the pages. The recommended packages for these approaches are:</p>
<ul>
<li><a href="http://httr.r-lib.org/"><code>httr</code></a> for communicating with web APIs</li>
<li><a href="https://www.rdocumentation.org/packages/jsonlite"><code>jsonlite</code></a> for reading JSON formatted text</li>
<li><a href="https://www.rdocumentation.org/packages/xml2"><code>xml2</code></a> for reading XML formatted text</li>
<li><a href="https://www.rdocumentation.org/packages/rvest"><code>rvest</code></a> for scraping web pages</li>
</ul>
</div>
</div>
<div id="tidying-data" class="section level2">
<h2>Tidying Data</h2>
<p>Now you have the data you want, it probably requires some processing in order to get it into a structure that is useful for analysis. There are two main packages for this <a href="http://tidyr.tidyverse.org"><code>tidyr</code></a> and <a href="http://dplyr.tidyverse.org"><code>dplyr</code></a>:</p>
<div id="tidyr" class="section level4">
<h4><a href="http://tidyr.tidyverse.org"><code>tidyr</code></a></h4>
<p>The focus of <a href="http://tidyr.tidyverse.org"><code>tidyr</code></a> is to get the data into a tidy format. The main functions it provides to do this are:</p>
<ul>
<li><a href="http://tidyr.tidyverse.org/reference/gather.html"><code>gather()</code></a> takes multiple columns, and gathers them into key-value pairs: it makes “wide” data longer.</li>
<li><a href="http://tidyr.tidyverse.org/reference/spread.html"><code>spread()</code></a> takes two columns (key &amp; value) and spreads in to multiple columns, it makes “long” data wider.</li>
<li><a href="http://tidyr.tidyverse.org/reference/separate.html"><code>separate()</code></a> and <a href="http://tidyr.tidyverse.org/reference/extract.html"><code>extract()</code></a> pulls apart a column that represents multiple variables.</li>
<li><a href="http://tidyr.tidyverse.org/reference/unite.html"><code>unite()</code></a> combines columns, useful if one is redundant.</li>
<li><a href="http://tidyr.tidyverse.org/reference/gather.html"><code>separate_rows()</code></a> for separating a row that contains multiple observations.</li>
</ul>
<p>In addition, <a href="http://tidyr.tidyverse.org"><code>tidyr</code></a> provides a set of functions for dealing with implicit and explicit missing values:</p>
<ul>
<li><a href="http://tidyr.tidyverse.org/reference/drop_na.html"><code>drop_na()</code></a>: Drop rows containing missing values</li>
<li><a href="http://tidyr.tidyverse.org/reference/replace_na.html"><code>replace_na()</code></a>: Replace missing values</li>
<li><a href="http://tidyr.tidyverse.org/reference/fill.html"><code>fill()</code></a>: Fill in missing values.</li>
<li><a href="http://tidyr.tidyverse.org/reference/complete.html"><code>complete()</code></a>: Complete a data frame with missing combinations of data.</li>
<li><a href="http://tidyr.tidyverse.org/reference/expand.html"><code>expand()</code></a>, <a href="http://tidyr.tidyverse.org/reference/expand.html"><code>crossing()</code></a>: Expand data frame to include all combinations of values</li>
</ul>
</div>
<div id="dplyr" class="section level4">
<h4><a href="http://dplyr.tidyverse.org"><code>dplyr</code></a></h4>
<p><a href="http://dplyr.tidyverse.org"><code>dplyr</code></a> is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges:</p>
<ul>
<li><a href="http://dplyr.tidyverse.org/reference/mutate.html"><code>mutate()</code></a> adds new variables that are functions of existing variables.</li>
<li><a href="http://dplyr.tidyverse.org/reference/select.html"><code>select()</code></a> picks variables based on their names.</li>
<li><a href="http://dplyr.tidyverse.org/reference/filter.html"><code>filter()</code></a> picks cases based on their values.</li>
<li><a href="http://dplyr.tidyverse.org/reference/summarise.html"><code>summarise()</code></a> reduces multiple values down to a single summary.</li>
<li><a href="http://dplyr.tidyverse.org/reference/arrange.html"><code>arrange()</code></a> changes the ordering of the rows.</li>
</ul>
<p>These all combine naturally with <a href="http://dplyr.tidyverse.org/reference/group_by.html"><code>group_by()</code></a> which allows you to perform any operation “by group”.</p>
<p><a href="http://dplyr.tidyverse.org"><code>dplyr</code></a> also provides a set of functions for combining tables. Mutating joins combine tables based on matching a subset of common variables; Set operations expect the tables to have the same variables and combine observations like sets.</p>
<p><strong>Mutating joins</strong></p>
<ul>
<li><a href="http://dplyr.tidyverse.org/reference/join.html"><code>inner_join(x, y)</code></a> only includes observations that match in both <code>x</code> and <code>y</code>.</li>
<li><a href="http://dplyr.tidyverse.org/reference/join.html"><code>left_join(x, y)</code></a> includes all observations in <code>x</code>, regardless of whether they match or not.</li>
<li><a href="http://dplyr.tidyverse.org/reference/join.html"><code>right_join(x, y)</code></a> includes all observations in <code>y</code>. It’s equivalent to <a href="http://dplyr.tidyverse.org/reference/join.html"><code>left_join(y, x)</code></a>, but the columns will be ordered differently.</li>
<li><a href="http://dplyr.tidyverse.org/reference/join.html"><code>full_join()</code></a> includes all observations from <code>x</code> and <code>y</code>.</li>
</ul>
<p><strong>Set operations</strong></p>
<ul>
<li><a href="http://dplyr.tidyverse.org/reference/setops.html"><code>intersect(x, y)</code></a>: returns only observations in both <code>x</code> and <code>y</code>.</li>
<li><a href="http://dplyr.tidyverse.org/reference/setops.html"><code>union(x, y)</code></a>: returns unique observations in <code>x</code> and <code>y</code>.</li>
<li><a href="http://dplyr.tidyverse.org/reference/setops.html"><code>setdiff(x, y)</code></a>: return observations in <code>x</code>, but not in <code>y</code>.</li>
</ul>
</div>
<div id="variable-types" class="section level4">
<h4>Variable Types</h4>
<p>There are also packages which simplify working with specific types of data:</p>
<ul>
<li><a href="http://stringr.tidyverse.org/"><code>stringr</code></a> for strings and regular expressions</li>
<li><a href="http://forcats.tidyverse.org/"><code>forcats</code></a> for factors, used to handle categorical data</li>
<li><a href="http://lubridate.tidyverse.org/"><code>lubridate</code></a> for dates and date-times.</li>
<li><a href="https://www.rdocumentation.org/packages/hms"><code>hms</code></a> for time-of-day values.</li>
</ul>
</div>
<div id="tibble" class="section level4">
<h4><a href="http://tibble.tidyverse.org/"><code>tibble</code></a></h4>
<p>When using these packages you may notice they return a <code>tibble</code> rather than a <code>data.frame</code>. They are basically the same thing with three key differences:</p>
<ol style="list-style-type: decimal">
<li>Printing: Tibbles only show the first ten rows and all the columns that fit on one screen.</li>
<li>Subsetting: <code>[</code> always returns another tibble. <code>$</code> never uses partial matching.</li>
<li>Recycling: Only values of length 1 are recycled. Trying to combine columns of different length throws an error.</li>
</ol>
<p>The package <a href="http://tibble.tidyverse.org/"><code>tibble</code></a> has some useful functions for constructing tibbles. In particaular, you can construct a tibble row-wise using the <a href="http://tibble.tidyverse.org/reference/tribble.html"><code>tribble</code></a> function (transposed tibble).</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
